
\documentclass{article}

\usepackage{times,multicol}
\usepackage{xcoffins}

\usepackage{color}
\newcommand\cbox[2][.8]{{\setlength\fboxsep{0pt}\colorbox[gray]{#1}{#2}}}

\newcommand\hrulebox [2]{\setbox#1\hbox to#2{{\scriptsize\itshape
                         \color{blue}\hrulefill #2\hrulefill}}}
\newcommand\vrulebox [2]{\setbox#1\vbox to#2{{\hsize 1pt\centering\scriptsize
                         \itshape\color{blue}\leaders\vrule\vfill
                         \hbox to0pt{\hss #2\hss}\leaders\vrule\vfill\par}}}




\showboxdepth 9999
\showboxbreadth 9999
\tracingonline 1


\scrollmode

\newbox\zzz


\begin{document}


\title{Test file for coffins}
\author{FMi}
\maketitle

First we add a few test coffins:
\begin{verbatim}
  \newcoffin \aaa
  \newcoffin \bbb
  \newcoffin \ccc
  \newcoffin \ddd
\end{verbatim}
  \newcoffin \aaa
  \newcoffin \bbb
  \newcoffin \ccc
  \newcoffin \ddd
and some boxes not set up as ordinary boxes (without extra handles):
\begin{verbatim}
  \newbox \xxx
  \newbox \yyy
\end{verbatim}
  \newbox \xxx
  \newbox \yyy


If a coffin receives data a set of ``natural'' default handles are automatically added.
\begin{verbatim}
\sbox\aaa{\fbox{\begin{tabular}[b]{l}123\\4\\5\end{tabular}}}
\showcoffinhandles \aaa
\end{verbatim}
\sbox\aaa{\fbox{\begin{tabular}[b]{l}123\\4\\5\end{tabular}}}
\showcoffinhandles \aaa


In contrast, boxes not declared as coffins have no handles defined. However, if
used as coffins at least the natural default handles can be used without
further problems, i.e.,they are changed to coffins automatically on use.
\begin{verbatim}
\sbox\xxx{\fbox{Some very looooonggg Caption Text}}
\showhandles \xxx
\end{verbatim}
\sbox\xxx{\fbox{Some very looooonggg Caption Text}}
\showcoffinhandles \xxx


Using \verb|\setvcoffin| instead of \verb|\sbox| gives us the codes with
\texttt{T} and \texttt{B}. Similar to \verb|\parbox| this command requires to
specify a target width of the box:
\begin{verbatim}
\setvcoffin \aaa {1.5cm} {\centering
   \fbox{\begin{tabular}[b]{l}123\\4\\5\end{tabular}}}
\showcoffinhandles \aaa
\end{verbatim}
\setvcoffin \aaa {1.5cm} {\centering
   \fbox{\begin{tabular}[b]{l}123\\4\\5\end{tabular}}}
\showcoffinhandles \aaa

There are a dozen natural handles per box (some with multiple names); you can
move each of the handles to someplace else (either to an absolute position in
``box space'' or relative to its previous position).  The coordinates can
refer to box dimensions (using \verb|\height|, \verb|\depth|,
 and \verb|width|). First we move some handle and add one
additional one:
\begin{verbatim}
\placecoffinhandle \aaa {tl}(0pt,\height -3pt)
\placecoffinhandle \aaa {mybottom}(\width / 2,\depth +2pt)
\showcoffinhandles \aaa
\end{verbatim}
\placecoffinhandle \aaa {tl}(0pt,\height -3pt)
\placecoffinhandle \aaa {mybottom}(\width / 2,\depth +2pt)
\showcoffinhandles \aaa

More interesting in many cases is the relative move of handles. For this the
handles better exist or one gets an error and \texttt{0pt,0pt} is used:
\begin{verbatim}
\adjustcoffinhandle \aaa {Hl}(1pt,1pt)
\adjustcoffinhandle \aaa {undefined}(1pt,1pt)
\showcoffinhandles \aaa
\end{verbatim}
\adjustcoffinhandle \aaa {Hl}(1pt,1pt)
\adjustcoffinhandle \aaa {undefined}(1pt,1pt)
\showcoffinhandles \aaa


\sbox \aaa {\fontsize{14.4}{5.5pc minus .5pc}\sffamily C\,H\,A\,P\,T\,E\,R 
            \fontsize{36}{40pt}\selectfont 2}

\setvcoffin \bbb {11cm}
   {\raggedleft\normalfont\fontsize{36}{38pt}\bfseries 
    The Structure of a \LaTeX{} Document}

\setvcoffin \ccc {13cm}
   {Some sample blind text to produce paragraph data after a heading.
    Some sample blind text to produce paragraph data after a heading.
    Some sample blind text to produce paragraph data after a heading.
    Some sample blind text to produce paragraph data after a heading.
    \par
    Some more sample blind text to produce paragraph data after a heading.
    Some more sample blind text to produce paragraph data after a heading.
}


Suppose you have the following blocks of text:

\bigskip

\noindent\cbox{\usebox\aaa}

\begin{multicols}{2}
\ttfamily\tiny
\ExplSyntaxOn
   \noindent \coffin_print_handle_values:Nn \aaa \\ 
\ExplSyntaxOff
\end{multicols}

\medskip

\noindent\cbox{\usebox\bbb}

\medskip

\noindent\cbox{\usebox\ccc}

\bigskip

produced by:
\begin{verbatim}
\sbox \aaa {\fontsize{14.4}{5.5pc minus .5pc}\sffamily 
             C\,H\,A\,P\,T\,E\,R 
            \fontsize{36}{40pt}\selectfont 2}
\setvcoffin \bbb {11cm}
   {\raggedleft\normalfont\fontsize{36}{38pt}\bfseries 
    The Structure of a \LaTeX{} Document}
\setvcoffin \ccc {13cm}
   {Some sample blind text to produce paragraph 
    data after a heading.                        ... }
\end{verbatim}

How do you turn this into a heading of TLC2?


\newbox\RBi
\newbox\RBii
\newbox\RBiii

\hrulebox\RBi{62pt}
\vrulebox\RBii{90pt}
\vrulebox\RBiii{60pt}

\aligncoffins  \bbb{Tr} \aaa{Hr}(-62pt,60pt)
  \aligncoffins * \bbb{Tc} \RBiii{bc}(28pt,0pt)
  \aligncoffins * \bbb{br} \RBi{Hr}(0pt,-5pt)
  \aligncoffins * \bbb{Bc} \RBii{tr}(14pt,0pt)
\aligncoffins * \ccc{Tr} \bbb{Br}(62pt,90pt)


\newpage

How do you best define/describe the following design?
\vspace*{10cm}

\noindent\cbox{\usebox\ccc}


\sbox \aaa {ABC}
%\showcoffinhandles \aaa
\sbox \bbb {321}
%\showcoffinhandles \bbb
\setvcoffin \ccc {5pt}{\noindent 9\\8\\7}
%\showcoffinhandles \ccc

\aligncoffins  \aaa{Hl} \bbb{Hr}

\noindent\cbox{\usebox\aaa}

\aligncoffins  \aaa {\aaa-bl} \ccc{tc}

\noindent\cbox{\usebox\aaa}

\noindent\cbox{\usebox\ccc}

\sbox \aaa {ABC}
\sbox \bbb {321}
\setvcoffin \ccc {5pt}{\noindent 9\\8\\7}

\aligncoffins * \aaa{Hl} \bbb{Hr}

\noindent\cbox{\usebox\aaa}

\aligncoffins  \aaa {\aaa-bl} \ccc{tc}

\noindent\cbox{\usebox\aaa}

\end{document}

\begin{verbatim}
\end{verbatim}

