


%  xparse-test.tex

\RequirePackage{xparse}

\DeclareDocumentCommand \foo { mmmm o mm o }
{ \typeout{1:#1}
  \typeout{2:#2}
  \typeout{3:#3}
  \typeout{4:#4}
  \typeout{5:#5}
  \typeout{6:#6}
  \typeout{7:#7}
  \typeout{8:#8}
}

\foo 1234[5]67[8]
\foo 123467

\show\foo
\expandafter\show\csname\string\foo\endcsname


\DeclareDocumentCommand \baz { O{?}mmm o mm m }
{ \typeout{1:#1}
  \typeout{2:#2}
  \typeout{3:#3}
  \typeout{4:#4}
  \typeout{5:#5}
  \typeout{6:#6}
  \typeout{7:#7}
  \typeout{8:#8}
}

\show\baz
\expandafter\show\csname\string\baz\endcsname

\baz [1]234[5]678
\makeatletter\showthe\toks@
\baz 234678
\makeatletter\showthe\toks@

%\tracingall\tracingassigns=1
\DeclareDocumentCommand \bar { mmmm mmmm m}
{ \typeout{1:#1}
  \typeout{2:#2}
  \typeout{3:#3}
  \typeout{4:#4}
  \typeout{5:#5}
  \typeout{6:#6}
  \typeout{7:#7}
  \typeout{8:#8}
  \typeout{9:#9}
}

\show\bar
\expandafter\show\csname\string\bar\endcsname

\bar 123456789
\makeatletter\showthe\toks@

\DeclareDocumentCommand\chapter{soom}
{\typeout{a{#1}^^Jb{#2}^^Jc{#3}^^Jd{#4}^^Je}}

\show\chapter
\expandafter\show\csname\string\chapter\endcsname

\typeout{1:}
\chapter*[xxx][yyy]{zzz}

\typeout{2:}
\chapter[xxx][yyy]{zzz}

\typeout{3:}
\chapter*[xxx]{zzz}

\typeout{4:}
\typeout{\chapter*[xxx][yyy]{zzz}}


\DeclareDocumentCommand\chapter{soom}
{\typeout{a{#1}^^Jb{#2}^^Jc{#3}^^Jd{#4}^^Je}}

\DeclareDocumentEnvironment{hello}{ooo}
  {\typeout{B1(#1)^^JB2(#2)^^JB3(#3)^^J}}
  {\typeout{E1(#1)^^JE2(#2)^^JE3(#3)^^J}}


\show\hello
\expandafter\show\csname\string\hello\endcsname

\show\endhello
\expandafter\show\csname end\string\\hello\endcsname

\begin{hello}[abc][aabbcc]
\typeout{body}
\typeout{5:}
\chapter[xxx][yyy]{zzz}
\end{hello}

\begin{hello}[1]
\typeout{outer body}
\hello [2] \typeout{inner body} \endhello
\end{hello}

\stop
