% \iffalse
%% File l3stuff.sty  Copyright 2004 Frank Mittelbach, LaTeX3 Project
%%
%% It may be distributed and/or modified under the conditions of the
%% LaTeX Project Public License (LPPL), either version 1.3a of this
%% license or (at your option) any later version.  The latest version
%% of this license is in the file
%%
%%    http://www.latex-project.org/lppl.txt
%%
%% This file is part of the ``xor bundle'' (The Work in LPPL)
%% and all files in that bundle must be distributed together.
%%
%% The released version of this bundle is available from CTAN.
%%
%% -----------------------------------------------------------------------
%%
%% The development version of the bundle can be found at
%%
%%    http://www.latex-project.org/cgi-bin/cvsweb.cgi/
%%
%% for those people who are interested.
%%
%%%%%%%%%%%
%% NOTE: %%
%%%%%%%%%%%
%%
%%   Snapshots taken from the repository represent work in progress and may
%%   not work or may contain conflicting material!  We therefore ask
%%   people _not_ to put them into distributions, archives, etc. without
%%   prior consultation with the LaTeX Project Team.
%%
%% -----------------------------------------------------------------------
%%
\def\next#1: #2.sty,v #3 #4 #5 #6 #7$#8{%
  \def\fileversion{#3}%
  \def\filedate{#4}%
  \ProvidesPackage{#2}[#4 #3 #5 #6]%
}
\next$Id$
          {}
% \fi
%
%
% tmp file that needs folding back to expl3
%

\NeedsTeXFormat{LaTeX2e}
\RequirePackage{l3toks}
\RequirePackage{l3quark}
\RequirePackage{l3expan}







%%%%%%%%%%%%%%%%%%%
%%% clist module
%%%%%%%%%%%%%%%%%%%


\iffalse %check
\def_new:Npn \clist_put_aux:Nnn #1{
  \exp_after:NN\clist_put_aux:w #1\q_stop #1}
\def_new:Npn \clist_put_aux:w #1\q_stop #2#3#4{\tlp_set:Nn #2{#3#1#4}}

\def_new:Npn \clist_put_left:Nn #1#2{
        \clist_if_empty:NTF#1
           {\tlp_set:Nn#1{#2}}
           {\clist_put_aux:Nnn #1{#2,}{}}
}
\def_new:Npn \clist_put_left:cn {\exp_args:Nc\clist_put_left:Nn}
\def_new:Npn \clist_put_left:No {\exp_args:NNo\clist_put_left:Nn}
\def_new:Npn \clist_put_left:Nx {\exp_args:Nnx\clist_put_left:Nn}

\def_new:Npn \clist_gput_left:Nn {
   \clist_put_left:Nn}
\fi


%%%%%%%%%%%%%%%%%%%
%%% box module
%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%
%%% exp module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
%%% seq module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
%%% num module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
%%% int module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
% tlp module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
% new names?
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
% missing?
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
% maybe ...
%%%%%%%%%%%%%%%%%%%

\let_new:NN  \cs_show:N \tex_show:D
\def_new:Npn \cs_show:c {\exp_args:Nc \cs_show:N}

\let_new:NN \cs_meaning:N \tex_meaning:D
\def_new:Npn \cs_meaning:c {\exp_args:Nc \cs_meaning:N}

%%%%%%%%%%%%%%%%%%%
%%% prop module
%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%
% modes
%%%%%%%%%%%%%%%%%%%
% All this should go into a module some day...
%
%  \begin{macro}{\scan_stop_safe:}
%  When \TeX{} is in the beginning of an align cell (right after the
%  |\cr| it is in a somewhat strange mode as it is looking ahead to
%  find an |\omit| or |\noalign| and hasn't looked at the preamble yet.
%  Thus an |\ifmmode| test will always fail unless we insert |\relax|
%  to stop \TeX's scanning ahead. However we only want to insert
%  |\relax| if we're certain we won't destroy any kerning!
%  |\scan_stop_safe:| inserts it iff a)~we're in the outer part of an
%  alignment cell, b)~the last node wasn't a char node or a ligature
%  node. We make sure to put the |\scan_stop:| after the closing |\fi:|
%  as that may be important in some scanner mechanisms.
%    \begin{macrocode}
\def_new:Npn \scan_stop_safe:{
  \if_num:w \etex_currentgrouptype:D = \c_six
    \if_num:w \etex_lastnodetype:D = \c_zero
    \else:
      \if_num:w \etex_lastnodetype:D = \c_seven
      \else:
        \exp_after:NN\exp_after:NN\exp_after:NN\exp_after:NN
        \exp_after:NN\exp_after:NN\exp_after:NN\scan_stop:
      \fi:
    \fi:
  \fi:
}
%    \end{macrocode}
%  \end{macro}
%
%
%  \begin{macro}{\mode_vertical:TF}
%  \begin{macro}{\mode_vertical:T}
%  For testing vertical mode.
%    \begin{macrocode}
\def_new:Npn \mode_vertical:TF {
  \tex_ifvmode:D
    \exp_after:NN \use_arg_i:nn
  \else:
    \exp_after:NN \use_arg_ii:nn
  \fi:}
\def_new:Npn \mode_vertical:T {
  \tex_ifvmode:D
    \exp_after:NN \use_arg_i:n
  \else:
    \exp_after:NN \use_none:n
  \fi:}
%    \end{macrocode}
%  \end{macro}
%  \end{macro}
%
%  \begin{macro}{\mode_horizontal:TF}
%  \begin{macro}{\mode_horizontal:T}
%  For testing horizontal mode.
%    \begin{macrocode}
\def_new:Npn \mode_horizontal:TF {
  \tex_ifhmode:D
    \exp_after:NN \use_arg_i:nn
  \else:
    \exp_after:NN \use_arg_ii:nn
  \fi:}
\def_new:Npn \mode_horizontal:T {
  \tex_ifhmode:D
    \exp_after:NN \use_arg_i:n
  \else:
    \exp_after:NN \use_none:n
  \fi:}
%    \end{macrocode}
%  \end{macro}
%  \end{macro}
%
%  \begin{macro}{\mode_inner:TF}
%  For testing inner mode.
%    \begin{macrocode}
\def_new:Npn \mode_inner:TF {
  \tex_ifinner:D
    \exp_after:NN \use_arg_i:nn
  \else:
    \exp_after:NN \use_arg_ii:nn
  \fi:}
%    \end{macrocode}
%  \end{macro}
%  \begin{macro}{\mode_math:TF}
%  For testing math mode. Uses the kern-save |\scan_stop_safe:|
%    \begin{macrocode}
\def_new:Npn \mode_math:TF {
  \scan_stop_safe:
  \tex_ifmmode:D
    \exp_after:NN \use_arg_i:nn
  \else:
    \exp_after:NN \use_arg_ii:nn
  \fi:}
%    \end{macrocode}
%  \end{macro}
\endinput
