%
% Copyright (C) 2011 LaTeX3 Project
% 

\documentclass{minimal}
\input{regression-test}

\RequirePackage{l3fp-aux}
\RequirePackage{l3fp-basics}
\RequirePackage{l3fp-convert}
\RequirePackage{l3fp-assign}

\begin{document}
\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\OMIT
\cs_set:Npn \test:nn #1 #2
  { \fp_assign_print:n { \fp_add:nn {#1} {#2} } }
\TIMO

\TEST{Addition~special~cases}{
  \iow_term:x {Expect~ nan,~nan,~nan,~nan,~nan,~nan.}
  \test:nn {nan} {nan}
  \test:nn {nan} {inf}
  \test:nn {nan} {-inf}
  \test:nn {nan} {1}
  \test:nn {nan} {0}
  \test:nn {nan} {-0}
  \iow_term:x {Expect~ nan,~inf,~error+nan,~inf,~inf,~inf.}
  \test:nn {inf} {nan}
  \test:nn {inf} {inf}
  \test:nn {inf} {-inf}
  \test:nn {inf} {1}
  \test:nn {inf} {0}
  \test:nn {inf} {-0}
  \iow_term:x {Expect~ nan,~error+nan,~ -inf,~ -inf,~ -inf,~ -inf.}
  \test:nn {-inf} {nan}
  \test:nn {-inf} {inf}
  \test:nn {-inf} {-inf}
  \test:nn {-inf} {1}
  \test:nn {-inf} {0}
  \test:nn {-inf} {-0}
  \iow_term:x {Expect~ nan,~ inf,~ -inf,~ 1,~ 1.}
  \test:nn {1} {nan}
  \test:nn {1} {inf}
  \test:nn {1} {-inf}
  \test:nn {1} {0}
  \test:nn {1} {-0}
  \iow_term:x {Expect~ nan,~ inf,~ -inf,~ 1,~ +0,~ +0.}
  \test:nn {0} {nan}
  \test:nn {0} {inf}
  \test:nn {0} {-inf}
  \test:nn {0} {1}
  \test:nn {0} {0}
  \test:nn {0} {-0}
  \iow_term:x {Expect~ nan,~ inf,~ -inf,~ 1,~ +0,~ -0.}
  \test:nn {-0} {nan}
  \test:nn {-0} {inf}
  \test:nn {-0} {-inf}
  \test:nn {-0} {1}
  \test:nn {-0} {0}
  \test:nn {-0} {-0}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Addition~positive}{
  \test:nn {1} {1}
  \test:nn {1.2} {3.4}
  \test:nn {0.1234567890123456789}{0.9876543210987654321}
  \test:nn {1234} {4321}
  \test:nn {13579238576348} {23573948576428} %37153187152776
  \test:nn {21342.39876238473423e23} {.9384123239423948238e30}
  \test:nn {912392184728736423847e623} {32324234234325234123124e634}
}

\TEST{Addition~opposite~signs}{
  \test:nn {1} {-1}
  \test:nn {1.2} {-3.4}
  \test:nn {0.1234567890123456789}{-0.9876543210987654321}
  \test:nn {1234} {-4321}
  \test:nn {13579238576348} {-23573948576428} %37153187152776
  \test:nn {21342.39876238473423e23} {-.9384123239423948238e30}
  \test:nn {912392184728736423847e623} {-32324234234325234123124e634}
}

% Todo: test expansion
% \iow_term:f { \fp_add:ww ...  \prg_do_nothing: \c_undefined:w }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\END
