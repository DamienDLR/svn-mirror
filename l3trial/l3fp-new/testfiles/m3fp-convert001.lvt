%
% Copyright (C) 2011 LaTeX3 Project
% 

\documentclass{minimal}
\input{regression-test}

\RequirePackage{l3fp-aux}
\RequirePackage{l3fp-basics}
\RequirePackage{l3fp-convert}
\RequirePackage{l3fp-assign}

\begin{document}
\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Constants}{
  \fp_assign_const:Nn \c_plus_one_fp  { 1 }
  \fp_assign_print:N  \c_plus_one_fp
  \fp_assign_const:Nn \c_minus_one_fp { -1 }
  \fp_assign_print:N  \c_minus_one_fp
  \fp_assign_const:Nn \c_minus_pi_fp  { - 3.14159265358979323846264 }
  \fp_assign_print:N  \c_minus_pi_fp
  \fp_assign_const:Nn \c_plus_pi_fp  { - \c_minus_pi_fp }
  \fp_assign_print:N  \c_plus_pi_fp
  \fp_assign_print:n { +-  \c_empty_qnan_fp }
  \fp_assign_print:n { -+  \c_plus_pi_fp }
  \fp_assign_print:n {-+-- \c_plus_pi_fp }
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Special~values}{
  \fp_assign_print:n { inf }
  \fp_assign_print:n { + inf }
  \fp_assign_print:n { - + inf }
  \fp_assign_print:n { - nan }
  \fp_assign_print:n { nan ...test... }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Testing~invalid~input}{
  \fp_assign_print:n { 1e2 . }
  \fp_assign_print:n { +- abc }
  \fp_assign_print:n { --+\relax bla } 
  \fp_assign_print:n { - }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Integer~part}{
  \fp_assign_print:n {1}
  \fp_assign_print:n {12}
  \fp_assign_print:n {123}
  \fp_assign_print:n {1234}
  \fp_assign_print:n {12345}
  \fp_assign_print:n {123456}
  \fp_assign_print:n {1234567}
  \fp_assign_print:n {12345678}
  \fp_assign_print:n {123456789}
  \fp_assign_print:n {1234567890}
  \fp_assign_print:n {12345678901}
  \fp_assign_print:n {123456789012}
  \fp_assign_print:n {1234567890123}
  \fp_assign_print:n {12345678901234}
  \fp_assign_print:n {123456789012345}
  \fp_assign_print:n {1234567890123456}
  \fp_assign_print:n {12345678901234567}
  \fp_assign_print:n {123456789012345678}
  \fp_assign_print:n {1234567890123456789}
  \fp_assign_print:n {12345678901234567890}
  \fp_assign_print:n {123456789012345678901}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Rounding}{
  \fp_assign_print:n {987654321098765449}
  \fp_assign_print:n {987654321098765450}
  \fp_assign_print:n {987654321098765451}
  \fp_assign_print:n {999999999999999999}
  \fp_assign_print:n {987654321098765549}
  \fp_assign_print:n {987654321098765550}
  \fp_assign_print:n {987654321098765551}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Unpacking}{
  \fp_assign_print:n {\c_twelve e\c_minus_one}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Large~mantissa}{
  \fp_assign_print:n {-.03e-100}
  \fp_assign_print:n {-.34e-100}
  \fp_assign_print:n {-3.45e-100}
  \fp_assign_print:n {-34.57e-100}
  \fp_assign_print:n {-345.72e-100}
  \fp_assign_print:n {-3457.28e-100}
  \fp_assign_print:n {-34572.83e-100}
  \fp_assign_print:n {-345728.34e-100}
  \fp_assign_print:n {-3457283.42e-100}
  \fp_assign_print:n {-34572834.23e-100}
  \fp_assign_print:n {-345728342.34e-100}
  \fp_assign_print:n {-3457283423.45e-100}
  \fp_assign_print:n {-34572834234.56e-100}
  \fp_assign_print:n {-345728342345.67e-100}
  \fp_assign_print:n {-3457283423456.78e-100}
  \fp_assign_print:n {-34572834234567.89e-100}
  \fp_assign_print:n {-345728342345678.91e-100}
  \fp_assign_print:n {-3457283423456789.12e-100}
  \fp_assign_print:n {-34572834234567891.23e-100}
  \fp_assign_print:n {-345728342345678912.34e-100}
  \fp_assign_print:n {-3457283423456789123.45e-100}
  \fp_assign_print:n {-34572834234567891234.56e-100}
  \fp_assign_print:n {-345728342345678912345.67e-100}
  \fp_assign_print:n {-3457283423456789123456.78e-100}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Zeros}{
  \fp_assign_print:n {-0000000000000000000.0000000000e-142345435}
  \fp_assign_print:n {-0000000000000000000.e-142345435}
  \fp_assign_print:n {.0e-142345435}
  \fp_assign_print:n {.e1}
  \fp_assign_print:n {-0000000000000000000.0000000000}
  \fp_assign_print:n {-0000000000000000000.}
  \fp_assign_print:n {.0}
  \fp_assign_print:n {.}
  \fp_assign_print:n { - \c_zero_fp }
  \fp_assign_print:n { \c_zero }
  \fp_assign_print:n { +-  \c_plus_zero_fp }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Small~mantissa}{
  \fp_assign_print:n {-0.0009e-14}
  \fp_assign_print:n {-0.00098e-14}
  \fp_assign_print:n {-0.000987e-14}
  \fp_assign_print:n {-0.0009876e-14}
  \fp_assign_print:n {-0.00098765e-14}
  \fp_assign_print:n {-0.000987654e-14}
  \fp_assign_print:n {-0.0009876543e-14}
  \fp_assign_print:n {-0.00098765432e-14}
  \fp_assign_print:n {-0.000987654321e-14}
  \fp_assign_print:n {-0.0009876543212e-14}
  \fp_assign_print:n {-0.00098765432123e-14}
  \fp_assign_print:n {-0.000987654321234e-14}
  \fp_assign_print:n {-0.0009876543212345e-14}
  \fp_assign_print:n {-0.00098765432123456e-14}
  \fp_assign_print:n {-0.000987654321234567e-14}
  \fp_assign_print:n {-0.0009876543212345678e-14}
  \fp_assign_print:n {-0.00098765432123456789e-14}
  \fp_assign_print:n {-0.000987654321234567898e-14}
  \fp_assign_print:n {-0.0009876543212345678987e-14}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Overflow~and~underflow}{
  \fp_assign_print:n {1 e 1234567}
  \fp_assign_print:n {1 e 1000000}
  \fp_assign_print:n {1 e  999999}
  \fp_assign_print:n { 0.01 e 1000000 }
  \fp_assign_print:n {1 e - 1234567}
  \fp_assign_print:n {1 e - 1000002}
  \fp_assign_print:n {1 e - 1000001}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\END
