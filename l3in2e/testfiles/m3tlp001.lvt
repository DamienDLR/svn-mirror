%
% Copyright (C) 2008 LaTeX3 Project
% 
\documentclass{minimal}
\RequirePackage{expl3}
\input{regression-test}
\begin{document}

\START
\AUTHOR{Frank Mittelbach}

\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{allocate~ new~ variables}{
  { \tlp_new:N  \l_XX_tlp }
  { \tlp_new:Nn \l_YY_tlp {foo} }
  { \tlp_new:Nn \g_ZZ_tlp {bar} }
  \tlp_show:N \l_XX_tlp
  \tlp_show:N \l_YY_tlp
  \tlp_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_set:Nn \l_XX_tlp {ZZ}

\TESTEXP{use~registers:~ expect~ foo~ bar}{
  \tlp_use:N \l_YY_tlp                      \space
  \tlp_use:c {g_ \tlp_use:N\l_XX_tlp _tlp}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_clear:N  \l_YY_tlp
\tlp_gclear:N \g_ZZ_tlp

\tlp_put_left:Nn \l_YY_tlp {bar}
\tlp_put_left:Nn \l_YY_tlp \l_XX_tlp

\tlp_gput_left:Nn \g_ZZ_tlp {foo}
\tlp_gput_left:No \g_ZZ_tlp \l_YY_tlp

\TESTEXP{testing~ clear~ and~ put_left:~ expect~ ZZbar~ ZZbarfoo}{
  \tlp_use:N \l_YY_tlp  \space
  \tlp_use:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{clear~ or~ allocate~ variables}{
  \tlp_clear_new:N \l_XX_tlp 
  \tlp_clear_new:c {l_aa_tlp}
  \tlp_gclear_new:N \g_ZZ_tlp
  \tlp_show:N \l_XX_tlp
  \tlp_show:N \l_aa_tlp
  \tlp_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_set:Nn \l_XX_tlp {XX}
\tlp_gset:Nn \g_ZZ_tlp {XX}

\TEST{clear~  inside~ group:~ expect~ XX~ <empty>}{
  {
   \tlp_clear_new:N \l_XX_tlp 
   \tlp_gclear_new:N \g_ZZ_tlp
  }
  \tlp_show:N \l_XX_tlp
  \tlp_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_gset:Nn \g_ZZ_tlp {! \l_XX_tlp !}
\tlp_gput_right:Nn \g_ZZ_tlp {1}
\tlp_gput_right:Nn \g_ZZ_tlp {2}
\tlp_gput_left:Nn \g_ZZ_tlp {a}
\tlp_gput_left:Nn \g_ZZ_tlp {b}

\tlp_set:Nn \l_YY_tlp {YY}
\tlp_put_left:Nn \l_YY_tlp {A}
\tlp_put_left:Nn \l_YY_tlp {B}
\tlp_put_right:Nn \l_YY_tlp {3}
\tlp_put_right:Nn \l_YY_tlp {4}
\tlp_put_right:No \l_YY_tlp \g_ZZ_tlp
\tlp_put_left:Nx  \l_YY_tlp \g_ZZ_tlp


\TEST{put~ left/right:~expect:~ ba!XX!12BAYY34ba!\l_XX_tlp~ !12}{
  \tlp_show:N \l_YY_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_put_right:Nn \l_YY_tlp {##1}

\TESTEXP{test~ \tlp_to_str:N~  expect:~ ba!XX!12BAYY34ba!\l_XX_tlp~ !12 ##1}{
  \tlp_to_str:N \l_YY_tlp
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\TEST{testing~ #:~ expect ~2~ \ERROR;~ ##1##2##3~ ##1##2##1##2}{
  \tlp_set:Nn \l_XX_tlp {####1}
  \tlp_put_right:No \l_XX_tlp {####2}
  \tlp_set:No \l_YY_tlp {\l_XX_tlp ##3}
  \tlp_gset:Nx \g_ZZ_tlp {\l_XX_tlp}
  \tlp_gput_right:Nx \g_ZZ_tlp {\g_ZZ_tlp}

  \tlp_show:N \l_YY_tlp
  \tlp_show:N \g_ZZ_tlp
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\TEST{testing~ set_eq:~ expect~ abc~ xyz}{
  \tlp_set:Nn    \l_tmpa_tlp {abc}
  \tlp_set:Nn    \l_tmpb_tlp {xyz}
{
   \tlp_set_eq:NN \l_tmpb_tlp \l_tmpa_tlp 
   \tlp_show:N \l_tmpb_tlp
}
{  \tlp_gset_eq:cc {g_ZZ_tlp} {l_tmpb_tlp} }
  \tlp_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_clear:N \l_tmpa_tlp
\tlp_set:Nn  \l_tmpb_tlp {~}
\tlp_set:Nn  \l_tmpc_tlp {\par}
\tlp_set:Nn  \l_tmpd_tlp {full}

\TESTEXP{test~ for~ empty:~ expect~ YES~ NO~ !!~ NO}{

\tlp_if_empty:NTF \l_tmpa_tlp \YES \NO  \space
\tlp_if_empty:NTF \l_tmpc_tlp \YES \NO  \space
! \tlp_if_empty:NT  \l_tmpd_tlp \YES   !\space
\tlp_if_empty:NF  \l_tmpb_tlp \NO 
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_clear:N \l_tmpa_tlp
\def:Npn\foo {}
\tlp_set:Nn \l_tmpb_tlp {abc}
\tlp_set:No \l_tmpc_tlp {\l_tmpb_tlp}
\tlp_set:Nn \l_tmpd_tlp {b}
\tlp_put_left:Nn \l_tmpd_tlp {a}
\tlp_put_right:Nn \l_tmpd_tlp {c}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{test~ for~ equal:~ expect~ YES~ YES~ !!~ NO}{
\tlp_if_eq:NNTF \l_tmpa_tlp \foo \YES \NO        \space
\tlp_if_eq:NNT \l_tmpb_tlp \l_tmpc_tlp \YES      \space
! \tlp_if_eq:NNF \l_tmpb_tlp \l_tmpd_tlp  \NO !  \space
\tlp_if_eq:NNTF \l_tmpa_tlp \l_tmpb_tlp \YES \NO
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\END

