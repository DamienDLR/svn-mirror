%
% Copyright (C) 2008 LaTeX3 Project
% 
\documentclass{minimal}
\input{regression-test}
\RequirePackage{expl3}
\ExplSyntaxOff
\begin{document}

\START
\AUTHOR{Frank Mittelbach}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{allocate~ new~ variables}{
  { \tl_new:N  \l_XX_tlp }
  { \tl_new:Nn \l_YY_tlp {foo} }
  { \tl_new:Nn \g_ZZ_tlp {bar} }
  \tl_show:N \l_XX_tlp
  \tl_show:N \l_YY_tlp
  \tl_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_set:Nn \l_XX_tlp {ZZ}

\TESTEXP{use~registers:~ expect~ foo~ bar}{
  \tl_use:N \l_YY_tlp                      \space
  \tl_use:c {g_ \tl_use:N\l_XX_tlp _tlp}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_clear:N  \l_YY_tlp
\tl_gclear:N \g_ZZ_tlp

\tl_put_left:Nn \l_YY_tlp {bar}
\tl_put_left:Nn \l_YY_tlp \l_XX_tlp

\tl_gput_left:Nn \g_ZZ_tlp {foo}
\tl_gput_left:No \g_ZZ_tlp \l_YY_tlp

\TESTEXP{testing~ clear~ and~ put_left:~ expect~ ZZbar~ ZZbarfoo}{
  \tl_use:N \l_YY_tlp  \space
  \tl_use:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{clear~ or~ allocate~ variables}{
  \tl_clear_new:N \l_XX_tlp 
  \tl_clear_new:c {l_aa_tlp}
  \tl_gclear_new:N \g_ZZ_tlp
  \tl_show:N \l_XX_tlp
  \tl_show:N \l_aa_tlp
  \tl_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_set:Nn \l_XX_tlp {XX}
\tl_gset:Nn \g_ZZ_tlp {XX}

\TEST{clear~  inside~ group:~ expect~ XX~ <empty>}{
  {
   \tl_clear_new:N \l_XX_tlp 
   \tl_gclear_new:N \g_ZZ_tlp
  }
  \tl_show:N \l_XX_tlp
  \tl_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_gset:Nn \g_ZZ_tlp {! \l_XX_tlp !}
\tl_gput_right:Nn \g_ZZ_tlp {1}
\tl_gput_right:Nn \g_ZZ_tlp {2}
\tl_gput_left:Nn \g_ZZ_tlp {a}
\tl_gput_left:Nn \g_ZZ_tlp {b}

\tl_set:Nn \l_YY_tlp {YY}
\tl_put_left:Nn \l_YY_tlp {A}
\tl_put_left:Nn \l_YY_tlp {B}
\tl_put_right:Nn \l_YY_tlp {3}
\tl_put_right:Nn \l_YY_tlp {4}
\tl_put_right:No \l_YY_tlp \g_ZZ_tlp
\tl_put_left:Nx  \l_YY_tlp \g_ZZ_tlp


\TEST{put~ left/right:~expect:~ ba!XX!12BAYY34ba!\l_XX_tlp~ !12}{
  \tl_show:N \l_YY_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_put_right:Nn \l_YY_tlp {##1}

\TESTEXP{test~ \tl_to_str:N~  expect:~ ba!XX!12BAYY34ba!\l_XX_tlp~ !12 ##1}{
  \tl_to_str:N \l_YY_tlp
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\TEST{testing~ #:~ expect ~2~ \ERROR;~ ##1##2##3~ ##1##2##1##2}{
  \tl_set:Nn \l_XX_tlp {####1}
  \tl_put_right:No \l_XX_tlp {####2}
  \tl_set:No \l_YY_tlp {\l_XX_tlp ##3}
  \tl_gset:Nx \g_ZZ_tlp {\l_XX_tlp}
  \tl_gput_right:Nx \g_ZZ_tlp {\g_ZZ_tlp}

  \tl_show:N \l_YY_tlp
  \tl_show:N \g_ZZ_tlp
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\TEST{testing~ set_eq:~ expect~ abc~ xyz}{
  \tl_set:Nn    \l_tmpa_tlp {abc}
  \tl_set:Nn    \l_tmpb_tlp {xyz}
{
   \tl_set_eq:NN \l_tmpb_tlp \l_tmpa_tlp 
   \tl_show:N \l_tmpb_tlp
}
{  \tl_gset_eq:cc {g_ZZ_tlp} {l_tmpb_tlp} }
  \tl_show:N \g_ZZ_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_clear:N \l_tmpa_tlp
\tl_set:Nn  \l_tmpb_tlp {~}
\tl_set:Nn  \l_tmpc_tlp {\par}
\tl_set:Nn  \l_tmpd_tlp {full}

\TESTEXP{test~ for~ empty:~ expect~ YES~ NO~ !!~ NO}{

\tl_if_empty:NTF \l_tmpa_tlp \YES \NO  \space
\tl_if_empty:NTF \l_tmpc_tlp \YES \NO  \space
! \tl_if_empty:NT  \l_tmpd_tlp \YES   !\space
\tl_if_empty:NF  \l_tmpb_tlp \NO 
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tl_clear:N \l_tmpa_tlp
\cs_set_nopar:Npn\foo {}
\tl_set:Nn \l_tmpb_tlp {abc}
\tl_set:No \l_tmpc_tlp {\l_tmpb_tlp}
\tl_set:Nn \l_tmpd_tlp {b}
\tl_put_left:Nn \l_tmpd_tlp {a}
\tl_put_right:Nn \l_tmpd_tlp {c}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{test~ for~ equal:~ expect~ YES~ YES~ !!~ NO}{
\tl_if_eq:NNTF \l_tmpa_tlp \foo \YES \NO        \space
\tl_if_eq:NNT \l_tmpb_tlp \l_tmpc_tlp \YES      \space
! \tl_if_eq:NNF \l_tmpb_tlp \l_tmpd_tlp  \NO !  \space
\tl_if_eq:NNTF \l_tmpa_tlp \l_tmpb_tlp \YES \NO
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\END

