%
% Copyright (C) 2009 LaTeX3 Project
% 
\documentclass{minimal}
\input{regression-test}

\RequirePackage{l3tlp}


\begin{document}
\START
\AUTHOR{Will~Robertson}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{reverse}{
  \tlp_set:Nn    \l_tmpa_tlp { abc \par xyz \ERROR {123} 123 }
  \tlp_show:N    \l_tmpa_tlp
  \tlp_reverse:N \l_tmpa_tlp
  \tlp_show:N    \l_tmpa_tlp
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_set:Nn      \l_tmpa_tlp { 123 }
\tlp_set:Nn      \l_tmpb_tlp { 123 {xyz} 567 }
\tlp_set:Nn      \l_tmpc_tlp { 123 {xyz} 567 \par ## 0 }
\TESTEXP{elt_count~(3/7/10)}{
  \tlp_elt_count:N \l_tmpa_tlp \space
  \tlp_elt_count:N \l_tmpb_tlp \space
  \tlp_elt_count:N \l_tmpc_tlp 
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{jobname}{\c_job_name_tlp}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_set:Nn \l_tmpa_tlp {abc{{A}B}C}
\cs_set:Npn \tlp_tmp:n #1 {[#1]~}

\TESTEXP{map_function}{
  \tlp_map_function:NN \l_tmpa_tlp \tlp_tmp:n
  \tlp_map_function:NN \l_tmpa_tlp {\tlp_tmp:n}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{map_inline}{
  \tlp_map_inline:Nn \l_tmpa_tlp {\TYPE{[#1]}}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{map_variable}{
  \tlp_map_variable:NNn \l_tmpa_tlp \ii {
    \TYPE{[\ii]~}
  }
}

\tlp_set:Nn \l_tmpa_tlp {a{bb}cdzyx\ERROR}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{map_break~inline/variable}{
  \tlp_map_inline:Nn \l_tmpa_tlp {
    \tlist_if_eq:nnTF {#1} {z} {
      \tlp_map_break:w
    }{
      \TYPE{[#1]}    
    }
  }  
  \SEPARATOR
  \tlp_map_variable:NNn \l_tmpa_tlp \ii {
    \tlist_if_eq:noTF {z} {\ii} {
      \tlp_map_break:w
    }{
      \TYPE{[\ii]}    
    }
  }
}

\cs_set:Npn \tlp_tmp:n #1 {    
  \tlist_if_eq:nnTF {#1} {z} {
    \tlp_map_break:w
  }{
    \TYPE{[#1]}    
  }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TEST{remove_in}{
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_in:Nn \l_tmpa_tlp {=/err=}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_in:cn {l_tmpa_tlp} {cc~dd}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_in:cn {l_tmpa_tlp} {Z}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
}

\TEST{gremove_in}{
  {    
    \TYPE { \tlp_to_str:N \l_tmpa_tlp }
    \tlp_gremove_in:Nn \l_tmpa_tlp {=/err=}
    \TYPE { \tlp_to_str:N \l_tmpa_tlp }
    \tlp_gremove_in:cn {l_tmpa_tlp} {cc~dd}
    \TYPE { \tlp_to_str:N \l_tmpa_tlp }
    \tlp_gremove_in:cn {l_tmpa_tlp} {Z}
  }
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\tlp_set:Nn \l_tmpa_tlp {aabbccaabbcc}

\TEST{remove_all_in}{
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_all_in:Nn \l_tmpa_tlp {zz}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_all_in:cn {l_tmpa_tlp} {aa}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_remove_all_in:cn {l_tmpa_tlp} {bbcc}
  \TYPE { >\tlp_to_str:N \l_tmpa_tlp< }
  \tlp_remove_all_in:cn {l_tmpa_tlp} {bbcc}
  \TYPE { >\tlp_to_str:N \l_tmpa_tlp< }
}

\TEST{gremove_all_in}{
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_gremove_all_in:Nn \l_tmpa_tlp {zz}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_gremove_all_in:cn {l_tmpa_tlp} {aa}
  \TYPE { \tlp_to_str:N \l_tmpa_tlp }
  \tlp_gremove_all_in:cn {l_tmpa_tlp} {bbcc}
  \TYPE { >\tlp_to_str:N \l_tmpa_tlp< }
  \tlp_gremove_all_in:cn {l_tmpa_tlp} {bbcc}
}

\typeout { Check~global:~>\tlp_to_str:N \l_tmpa_tlp< }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\END

