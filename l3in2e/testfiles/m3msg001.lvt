%
% Copyright (C) 2009 LaTeX3 Project
% 

\documentclass{minimal}
\input{regression-test}
% Leave some padding so that the line numbers 
% of the tests don't change later on.

\RequirePackage{expl3}

\begin{document}
\START
\AUTHOR{Joseph~Wright}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Making~some~new~messages}{
  \msg_new:nnnnn {module} {name1} {text} {more~text} {code}
  \msg_new:nnnn {module}  {name2} {text} {more~text} 
  \msg_new:nnn {module}   {name3} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Making~some~messages~using~set}{
  \msg_set:nnnnn {module} {name} {text} {more~text} {code}
  \msg_set:nnnn  {module} {name} {text} {more~text} 
  \msg_set:nnn   {module} {name} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Trying~to~make~new~messages~which~already~exist}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text} {more~text} {code}
  \TIMO
  \msg_new:nnnnn {module} {name} {text} {more~text} {code}
  \msg_new:nnnn  {module} {name} {text} {more~text} 
  \msg_new:nnn   {module} {name} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{New~types~of~message}{
  \msg_class_new:nn {example} {code}
  \msg_class_set:nn {example} {code}
  \msg_class_new:nn {example} {code}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~error~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_error:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_error:nnx  {module} {name} {\l_test_tl} 
  \msg_error:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~fatal~messages~(without~stopping!)}{
  \OMIT
  \cs_set_eq:NN \tex_end:D \scan_stop:
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_fatal:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_fatal:nnx  {module} {name} {\l_test_tl} 
  \msg_fatal:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~warning~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_warning:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_warning:nnx  {module} {name} {\l_test_tl} 
  \msg_warning:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~info~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_info:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_info:nnx  {module} {name} {\l_test_tl} 
  \msg_info:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~log~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_log:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_log:nnx  {module} {name} {\l_test_tl} 
  \msg_log:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~trace~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_trace:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_trace:nnx  {module} {name} {\l_test_tl} 
  \msg_trace:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{"Issuing"~none~messages}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_none:nnxx {module} {name} {\l_test_tl} {\l_test_tl}
  \msg_none:nnx  {module} {name} {\l_test_tl} 
  \msg_none:nn   {module} {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Redirection~of~messages:~by~class}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~} {more~text} {code}
  \TIMO
  \msg_redirect_class:nn {error} {warning}
  \msg_error:nn {module} {name}
}
\TEST{Redirection~of~messages:~by~module}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~} {more~text} {code}
  \msg_redirect_module:nnn {module} {error} {warning}
  \TIMO
  \msg_error:nn {module} {name}
}
\TEST{Redirection~of~messages:~by~name}{
  \OMIT
  \msg_new:nnnnn {module} {name} {text~} {more~text} {code}
  \TIMO
  \msg_redirect_name:nnn {module} {name} {warning}
  \msg_error:nn {module} {name}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Simple~text~commands}{
  \OMIT
  \msg_set:nnn {module} {name} {
    TEXT
    \msg_line_context:
    TEXT
    \msg_line_number:
    TEXT
    \msg_newline:
    TEXT
    \msg_two_newlines:
    TEXT
    \msg_space:
    TEXT
    \msg_two_spaces:
    TEXT
    \msg_four_spaces:
    TEXT
  }
  \TIMO
  \msg_error:nn {module} {name}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Generic~new~messages}{
  \msg_generic_new:nnnn {name1} {text} {more~text} {code}
  \msg_generic_new:nnn  {name2} {text} {more~text}
  \msg_generic_new:nn   {name3} {text}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Generic~set~messages}{
  \msg_generic_set:nnnn {name} {text} {more~text} {code}
  \msg_generic_set:nnn  {name} {text} {more~text}
  \msg_generic_set:nn   {name} {text}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Trying~to~make~new~generic~messages~which~already~exist}{
  \OMIT
  \msg_generic_new:nnnn {name} {text} {more~text} {code}
  \TIMO
  \msg_generic_new:nnnn {name} {text} {more~text} {code}
  \msg_generic_new:nnn  {name} {text} {more~text}
  \msg_generic_new:nn   {name} {text}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Direct~interruption}{
  \msg_direct_interrupt:xxxxn {first~line} {main~text \\ ~over~two~lines} 
    {continued} {more~text} {code}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Direct~messages}{
  \msg_direct_log:xx  {main \\ ~over~two~lines} {continued} 
  \msg_direct_term:xx {main \\ ~over~two~lines} {continued} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Making~new~kernel~messages}{
  \msg_kernel_new:nnnn {name1} {text} {more~text} {code}
  \msg_kernel_new:nnn  {name2} {text} {more~text} 
  \msg_kernel_new:nn   {name3} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Making~kernel~messages~using~set}{
  \msg_kernel_set:nnnn {name} {text} {more~text} {code}
  \msg_kernel_set:nnn  {name} {text} {more~text} 
  \msg_kernel_set:nn   {name} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Trying~to~make~new~kernel~messages~which~already~exist}{
  \OMIT
  \msg_kernel_new:nnnn {name} {text} {more~text} {code}
  \TIMO
  \msg_kernel_new:nnnn {name} {text} {more~text} {code}
  \msg_kernel_new:nnn  {name} {text} {more~text} 
  \msg_kernel_new:nn   {name} {text} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~kernel~fatal~messages~(without~stopping!)}{
  \OMIT
  \cs_set_eq:NN \tex_end:D \scan_stop:
  \msg_kernel_new:nnnn {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_kernel_fatal:nxx {name} {\l_test_tl} {\l_test_tl}
  \msg_kernel_fatal:nx  {name} {\l_test_tl} 
  \msg_kernel_fatal:n   {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~kernel~warning~messages}{
  \OMIT
  \msg_kernel_new:nnnn {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_kernel_warning:nxx {name} {\l_test_tl} {\l_test_tl}
  \msg_kernel_warning:nx  {name} {\l_test_tl} 
  \msg_kernel_warning:n   {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Issuing~kernel~info~messages}{
  \OMIT
  \msg_kernel_new:nnnn {name} {text~#1} {more~text~#1~#2} {code}
  \tl_set:Nn \l_test_tl {text}
  \TIMO
  \msg_kernel_info:nxx {name} {\l_test_tl} {\l_test_tl}
  \msg_kernel_info:nx  {name} {\l_test_tl} 
  \msg_kernel_info:n   {name} 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{The~"coding~bug"~warnings}{
   \msg_kernel_bug:xx {text} {more~text}
   \msg_kernel_bug:x  {text}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\END

