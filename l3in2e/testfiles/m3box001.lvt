%
% Copyright (C) 2009 LaTeX3 Project
% 

\documentclass{minimal}
\input{regression-test}
% Leave some padding so that the line numbers 
% of the tests don't change later on.

\RequirePackage{expl3}

\begin{document}
\START
\AUTHOR{Joseph Wright}
\ExplSyntaxOn

\OMIT
\box_new:N \l_h_box
\hbox_set:Nn \l_h_box {text}
\box_new:N \l_v_box
\vbox_set:Nn \l_v_box {\box_use:N \l_h_box}
\box_new:N \l_empty_box
\TIMO

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{New~box}{
  \box_new:N \l_testa_box
  \box_new:c {l_testb_box}
}
\TEST{Erroneous~new~boxes}{
  \OMIT
  \box_new:N \l_test_box
  \TIMO
  \box_new:N \l_test_box
  \box_new:c {l_test_box}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Generic~box~tests~(expect~T/F/F/T/T/F)}{
  \if_hbox:N \l_h_box \TRUE \else: \FALSE \fi:
  \if_hbox:N \l_v_box \TRUE \else: \FALSE \fi:
  \if_vbox:N \l_h_box \TRUE \else: \FALSE \fi:
  \if_vbox:N \l_v_box \TRUE \else: \FALSE \fi:
  \if_box_empty:N \l_empty_box \TRUE \else: \FALSE \fi:
  \if_box_empty:N \l_v_box \TRUE \else: \FALSE \fi:
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Higher-level~if~horizontal~(expect~T/T/F/F/T/T/F/F)}{
  \box_if_horizontal:NF \l_h_box {\FALSE}
  \box_if_horizontal:NT \l_h_box {\TRUE} 
  \box_if_horizontal:NTF \l_h_box {\TRUE} {\FALSE}
  \box_if_horizontal:NF \l_v_box {\FALSE}
  \box_if_horizontal:NT \l_v_box {\TRUE} 
  \box_if_horizontal:NTF \l_v_box {\TRUE} {\FALSE}
  \box_if_horizontal:cF {l_h_box} {\FALSE}
  \box_if_horizontal:cT {l_h_box} {\TRUE} 
  \box_if_horizontal:cTF {l_h_box} {\TRUE} {\FALSE}
  \box_if_horizontal:cF {l_v_box} {\FALSE}
  \box_if_horizontal:cT {l_v_box} {\TRUE} 
  \box_if_horizontal:cTF {l_v_box} {\TRUE} {\FALSE}
}
\TEST{Higher-level~if~vertical~(expect~F/F/T/T/F/F/T/T)}{
  \box_if_vertical:NF \l_h_box {\FALSE}
  \box_if_vertical:NT \l_h_box {\TRUE} 
  \box_if_vertical:NTF \l_h_box {\TRUE} {\FALSE}
  \box_if_vertical:NF \l_v_box {\FALSE}
  \box_if_vertical:NT \l_v_box {\TRUE} 
  \box_if_vertical:NTF \l_v_box {\TRUE} {\FALSE}
  \box_if_vertical:cF {l_h_box} {\FALSE}
  \box_if_vertical:cT {l_h_box} {\TRUE} 
  \box_if_vertical:cTF {l_h_box} {\TRUE} {\FALSE}
  \box_if_vertical:cF {l_v_box} {\FALSE}
  \box_if_vertical:cT {l_v_box} {\TRUE} 
  \box_if_vertical:cTF {l_v_box} {\TRUE} {\FALSE}
}
\TEST{Higher-level~if~empty~(expect~F/F/T/T/F/F/T/T)}{
  \box_if_empty:NF \l_h_box {\FALSE}
  \box_if_empty:NT \l_h_box {\TRUE} 
  \box_if_empty:NTF \l_h_box {\TRUE} {\FALSE}
  \box_if_empty:NF \l_empty_box {\FALSE}
  \box_if_empty:NT \l_empty_box {\TRUE} 
  \box_if_empty:NTF \l_v_box {\TRUE} {\FALSE}
  \box_if_empty:cF {l_h_box} {\FALSE}
  \box_if_empty:cT {l_h_box} {\TRUE} 
  \box_if_empty:cTF {l_h_box} {\TRUE} {\FALSE}
  \box_if_empty:cF {l_empty_box} {\FALSE}
  \box_if_empty:cT {l_empty_box} {\TRUE} 
  \box_if_empty:cTF {l_empty_box} {\TRUE} {\FALSE}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\TEST{Higher-level~if~horizontal~predicate}{
  \box_if_horizontal_p:N \l_h_box
  \box_if_horizontal_p:N \l_v_box
  \box_if_horizontal_p:c {l_h_box}
  \box_if_horizontal_p:c {l_v_box}
}
\TEST{Higher-level~if~vertical~predicate}{
  \box_if_vertical_p:N \l_h_box
  \box_if_vertical_p:N \l_v_box
  \box_if_vertical_p:c {l_h_box}
  \box_if_vertical_p:c {l_v_box}
}
\TEST{Higher-level~if~empty~predicate}{
  \box_if_empty_p:N \l_h_box
  \box_if_empty_p:N \l_empty_box
  \box_if_empty_p:c {l_h_box}
  \box_if_empty_p:c {l_empty_box}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\END
