%
% Copyright (C) 2011 LaTeX3 Project
% 
\documentclass{minimal}
\input{regression-test}
\RequirePackage[log-functions]{expl3}

\begin{document}

\START
\AUTHOR{Bruno Le Floch}
\ExplSyntaxOn

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{tl_if_single}{
  \tl_if_single:nTF {}               ?F
  \tl_if_single:nTF {~}              T?
  \exp_args:Nf \tl_if_single:nTF
    { \prg_replicate:nn {5} {~} }    T?
  \tl_if_single:nTF {\foo}           T?
  \tl_if_single:nTF {^^65}           T?
  \tl_if_single:nTF {~\foo}          T?
  \tl_if_single:nTF { * ~ }          ?F
  \tl_if_single:nTF { ~*~ }          ?F
  \tl_if_single:nTF { A B }          ?F
  \tl_if_single:nTF { { } }          T?
  \tl_if_single:nTF { { }~}          ?F
  \tl_if_single:nTF {~{ } }          T?
  \tl_if_single:nTF {~{ }~}          ?F
  \tl_if_single:nTF { {A} }          T?
  \tl_if_single:nTF { {A}~}          ?F
  \tl_if_single:nTF {~{A} }          T?
  \tl_if_single:nTF {~{A}~}          ?F
  \tl_if_single:nTF {A{B} }          ?F
  \tl_if_single:nTF { {B}A}          ?F
  \tl_if_single:nTF {{} {}}          ?F
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{tl_if_single_item}{
  \tl_if_single_item:nTF {}               ?F
  \tl_if_single_item:nTF {~}              ?F
  \exp_args:Nf \tl_if_single_item:nTF
    { \prg_replicate:nn {5} {~} }         ?F
  \tl_if_single_item:nTF {\foo}           T?
  \tl_if_single_item:nTF {^^65}           T?
  \tl_if_single_item:nTF {~\foo}          T?
  \tl_if_single_item:nTF { * ~ }          T?
  \tl_if_single_item:nTF { ~*~ }          T?
  \tl_if_single_item:nTF { A B }          ?F
  \tl_if_single_item:nTF { { } }          T?
  \tl_if_single_item:nTF { { }~}          T?
  \tl_if_single_item:nTF {~{ } }          T?
  \tl_if_single_item:nTF {~{ }~}          T?
  \tl_if_single_item:nTF { {A} }          T?
  \tl_if_single_item:nTF { {A}~}          T?
  \tl_if_single_item:nTF {~{A} }          T?
  \tl_if_single_item:nTF {~{A}~}          T?
  \tl_if_single_item:nTF {A{B} }          ?F
  \tl_if_single_item:nTF { {B}A}          ?F
  \tl_if_single_item:nTF {{} {}}          ?F
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{tl_if_single_token}{
  \tl_if_single_token:nTF {}               ?F
  \tl_if_single_token:nTF {~}              T?
  \exp_args:Nf \tl_if_single_token:nTF
    { \prg_replicate:nn {5} {~} }          ?F
  \tl_if_single_token:nTF {\foo}           T?
  \tl_if_single_token:nTF {^^65}           T?
  \tl_if_single_token:nTF {~\foo}          ?F
  \tl_if_single_token:nTF { * ~ }          ?F
  \tl_if_single_token:nTF { ~*~ }          ?F
  \tl_if_single_token:nTF { A B }          ?F
  \tl_if_single_token:nTF { { } }          ?F
  \tl_if_single_token:nTF { { }~}          ?F
  \tl_if_single_token:nTF {~{ } }          ?F
  \tl_if_single_token:nTF {~{ }~}          ?F
  \tl_if_single_token:nTF { {A} }          ?F
  \tl_if_single_token:nTF { {A}~}          ?F
  \tl_if_single_token:nTF {~{A} }          ?F
  \tl_if_single_token:nTF {~{A}~}          ?F
  \tl_if_single_token:nTF {A{B} }          ?F
  \tl_if_single_token:nTF { {B}A}          ?F
  \tl_if_single_token:nTF {{} {}}          ?F
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{tl_if_head_begin_group}{
  \tl_if_head_begin_group:nTF {}               ?F
  \tl_if_head_begin_group:nTF {~}              ?F
  \exp_args:Nf \tl_if_head_begin_group:nTF
    { \prg_replicate:nn {5} {~} }              ?F
  \tl_if_head_begin_group:nTF {\foo}           ?F
  \tl_if_head_begin_group:nTF {^^65}           ?F
  \tl_if_head_begin_group:nTF {~\foo}          ?F
  \tl_if_head_begin_group:nTF { * ~ }          ?F
  \tl_if_head_begin_group:nTF { ~*~ }          ?F
  \tl_if_head_begin_group:nTF { A B }          ?F
  \tl_if_head_begin_group:nTF { { } }          T?
  \tl_if_head_begin_group:nTF { { }~}          T?
  \tl_if_head_begin_group:nTF {~{ } }          ?F
  \tl_if_head_begin_group:nTF {~{ }~}          ?F
  \tl_if_head_begin_group:nTF { {A} }          T?
  \tl_if_head_begin_group:nTF { {A}~}          T?
  \tl_if_head_begin_group:nTF {~{A} }          ?F
  \tl_if_head_begin_group:nTF {~{A}~}          ?F
  \tl_if_head_begin_group:nTF {A{B} }          ?F
  \tl_if_head_begin_group:nTF { {B}A}          T?
  \tl_if_head_begin_group:nTF {{} {}}          T?
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\TESTEXP{tl_if_head_eq_space}{
  \tl_if_head_eq_space:nTF {}               ?F
  \tl_if_head_eq_space:nTF {~}              T?
  \exp_args:Nf \tl_if_head_eq_space:nTF
    { \prg_replicate:nn {5} {~} }           T?
  \tl_if_head_eq_space:nTF {\foo}           ?F
  \tl_if_head_eq_space:nTF {^^65}           ?F
  \tl_if_head_eq_space:nTF {~\foo}          T?
  \tl_if_head_eq_space:nTF { * ~ }          ?F
  \tl_if_head_eq_space:nTF { ~*~ }          T?
  \tl_if_head_eq_space:nTF { A B }          ?F
  \tl_if_head_eq_space:nTF { { } }          ?F
  \tl_if_head_eq_space:nTF { { }~}          ?F
  \tl_if_head_eq_space:nTF {~{ } }          T?
  \tl_if_head_eq_space:nTF {~{ }~}          T?
  \tl_if_head_eq_space:nTF { {A} }          ?F
  \tl_if_head_eq_space:nTF { {A}~}          ?F
  \tl_if_head_eq_space:nTF {~{A} }          T?
  \tl_if_head_eq_space:nTF {~{A}~}          T?
  \tl_if_head_eq_space:nTF {A{B} }          ?F
  \tl_if_head_eq_space:nTF { {B}A}          ?F
  \tl_if_head_eq_space:nTF {{} {}}          ?F
}

\END